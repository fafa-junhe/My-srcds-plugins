/* Plugin Template generated by Pawn Studio */

#include <sourcemod>

public Plugin:myinfo = 
{
	name = "Generic Refresh",
	author = "xNos",
	description = "Short commands to refresh everything about the server.",
	version = "1.0",
	url = "HL2.co.il"
};
public OnPluginStart()
{
	RegAdminCmd( "sm_rm", RefreshMapCMD, ADMFLAG_CHANGEMAP, "Refresh The Server Map." );
	RegAdminCmd( "sm_refreshmap", RefreshMapCMD, ADMFLAG_CHANGEMAP, "Refresh The Server Map." );
	
	RegAdminCmd( "sm_rp", RefreshPluginsCMD, ADMFLAG_RCON, "Refresh The Server Plugins." );
	RegAdminCmd( "sm_refreshplugins", RefreshPluginsCMD, ADMFLAG_RCON, "Refresh The Server Plugins." );
	
	RegAdminCmd( "sm_rc", RefreshConfigCMD, ADMFLAG_CONFIG, "Refresh The Server Config." );
	RegAdminCmd( "sm_refreshconfig", RefreshConfigCMD, ADMFLAG_CONFIG, "Refresh The Server Config." );
	
	RegAdminCmd( "sm_ra", RefreshAdminsCMD, ADMFLAG_BAN, "Refresh The Server Admins." );
	RegAdminCmd( "sm_refreshadmins", RefreshAdminsCMD, ADMFLAG_BAN, "Refresh The Server Admins." );
}
public Action:RefreshMapCMD( Client, args )
{
	new String:map[128]; 
	GetCurrentMap(map, sizeof(map));
	ForceChangeLevel( map, "RefreshMap" );
	return Plugin_Handled;
}
public Action:RefreshPluginsCMD( Client, args )
{
	ServerCommand("sm plugins unload_all");
	ServerCommand("sm plugins refresh");
	ReplyToCommand( Client, "[SM] You have refreshed the plugins." );
	return Plugin_Handled;
}
public Action:RefreshConfigCMD( Client, args )
{
	ServerCommand( "exec server.cfg" )
	ReplyToCommand( Client, "[SM] You have refreshed the server config." );
	return Plugin_Handled;
}
public Action:RefreshAdminsCMD( Client, args )
{
	DumpAdminCache(AdminCache_Groups, true);
	DumpAdminCache(AdminCache_Overrides, true);
	ReplyToCommand( Client, "[SM] You have refreshed the server admins." );
	return Plugin_Handled;
}